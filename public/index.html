<!DOCTYPE html>
<!-- -*- coding:utf-8 -*- -->
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap-theme.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.css" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/vue/1.0.26/vue.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
    <script src="/js/map.js"></script>
    <script src="/js/index.js"></script>
    <style>
      .clickable {
        cursor: pointer;
      }
    </style>
    <title>Ingress Mission Recommender</title>
  </head>
  <body>
    <div class="container" role="main">
      <div class="jumbotron">
        <h1>Mission Recommender</h1>
        <p>For Ingress Agent</p>
      </div>

      <div id="message">
        <div class="alert alert-warning" role="alert" v-if="isError">
          {{ message }}
        </div>
      </div>

      <form class="form-inline" id="control">
        <button type="button" class="btn btn-default" id="gps" @click="gps()">
          <span class="glyphicon glyphicon-globe"></span>
        </button>

        <div class="form-group">
          <label for="latitude">Latitude</label>
          <input type="text" class="form-control" id="latitude" v-model="pos.lat">
        </div>

        <div class="form-group">
          <label for="longitude">Longitude</label>
          <input type="text" class="form-control" id="longitude" v-model="pos.lng">
        </div>

        <div class="form-group">
          <label for="meter">Region(meter)</label>
          <input type="number" class="form-control" id="meter" v-model="meter">
        </div>

        <button type="button" class="btn btn-default" @click="change()">Change</button>
      </form>

      <form class="form-inline" id="location" @submit.prevent="search()">
        <div class="form-group">
          <label for="address">Address</label>
          <input type="text" class="form-control" id="address" v-model="address">
        </div>

        <button type="button" class="btn btn-default" @click="search()">Search</button>
      </form>

      <form class="form-inline" id="name" @submit.prevent="search()">
        <div class="form-group">
          <label for="mission_name">Mission Name</label>
          <input type="text" class="form-control" id="mission_name" v-model="name">
        </div>

        <button type="button" class="btn btn-default" @click="search()">Search</button>
      </form>

      <div id="map" style="width: 860px; height: 640px;"></div>
      <form id="map_form">
        <button type="button" class="btn btn-default pull-right" @click="clear()">MapClear</button>
      </form>

      <table class="table table-striped table-condensed" id="recommend">
        <tr><th>Name</th><th>To</th><th>Around</th><th>Portal</th><th></th></tr>
        <tr class="clickable" v-for="m in missions" @click="openMap(m)">
          <td>{{ m.name }}</td>
          <td>{{ m.bearing }} {{ m.to.toFixed(1) }} m</td>
          <td>{{ m.around.toFixed(1) }} m</td>
          <td>{{ m.portals.length }}</td>
          <td>
            <button type="button" class="btn btn-xs" @click="clear($index)" v-if="!m.isClear">Clear</button>
            <button type="button" class="btn btn-xs" @click="feedback($index, 1)" v-if="m.feedback <= 0">
              <span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span>
            </button>
            <button type="button" class="btn btn-xs" @click="feedback($index, -1)" v-if="0 <= m.feedback">
              <span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span>
            </button>
            <button type="button" class="btn btn-xs" @click="notFound($index)" v-if="!m.notFound">
              NotFound
            </button>
          </td>
        </tr>
      </table>

      <form id="all_clear" @submit.prevent="allClear()">
        <button type="button" class="btn btn-xs btn-warning" @click="allClear()">ALL CLEAR</button>
      </form>

      <ul>
        <li>Toは最初のportalまでの距離、Aroundは全てのportalを回るのに移動する推定距離を示す</li>
      </ul>
    </div>
  </body>
</html>
